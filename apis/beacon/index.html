
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="index.css">
</head>
<body style="background-color: purple;">
    <h1 style="text-align:center">Quanto tempo comtemplas o dragão?<h1>

    <label id = 'lblTime'></label>
    <br>
    <script>
    const fromDate = new Date();
    let timeSpent = 0;
    const  url = new URL(window.location.href);
    let id = url.searchParams.get("id");
    if (id === null || id<=0)
        id = 1;
    else if(id>=6 )
        id=5
    else
        id = parseInt(id);
    
    updateTime();

    const img = document.createElement("img")
    img.src = `${url.origin}/img/${id}.png`   
    img.style.width="500px";
    img.style.height="450px"
    document.body.appendChild(img);
    
    document.body.appendChild(document.createElement("br"))

    const next = document.createElement("a");
    next.href = `http://localhost:8080/?id=${id+1}`
    next.textContent = "Próximo"


    const prev = document.createElement("a");
    prev.href = `http://localhost:8080/?id=${id-1}`
    prev.textContent = "Anterior"
    
    
    
    window.addEventListener("unload", () => {
        const b = navigator.sendBeacon(`http://localhost:8080?id=${id}&timespent=${timeSpent}`)
    
    })
    document.body.appendChild(next);
    document.body.appendChild(document.createElement("br"))

    document.body.appendChild(prev);

    function updateTime()
     {
        const toDate = new Date();
        timeSpent = toDate.getTime() - fromDate.getTime();
        document.getElementById("lblTime").textContent = timeSpent + "ms"
        setTimeout(updateTime, 100)
    }
    </script>
</body>
</html>